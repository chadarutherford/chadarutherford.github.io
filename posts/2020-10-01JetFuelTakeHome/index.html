<!DOCTYPE html><html lang="en"><head><title>Chad Rutherford - iOS Developer with experience in Swift and Objective-C</title><meta name="twitter:title" content="Chad Rutherford - iOS Developer with experience in Swift and Objective-C"/><meta name="og:title" content="Chad Rutherford - iOS Developer with experience in Swift and Objective-C"/><meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous"/><script src="https://kit.fontawesome.com/67788e6bc8.js" crossorigin="anonymous"></script><link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css"/><link rel="stylesheet" href="/Pure/styles.css"/><link rel="stylesheet" href="/all.css"/><link rel="shortcut icon" href="/images/favicon.png"/></head><body><div id="layout" class="pure-g"><div><div class="pure-menu pure-menu-horizontal pure-u-1-1 top-header"><a class="pure-menu-heading" href="/">Chad Rutherford - Portfolio</a><ul class="pure-menu-list"><li class="pure-menu-item"><a class="pure-menu-link" href="/projects">Projects</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/posts">Blog</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/about">About</a></li></ul></div></div><div class="sidebar pure-u-1 pure-u-md-1-4"><div class="header"><div id="layout" class="pure-g"><div class="author__avatar"><img src="https://avatars2.githubusercontent.com/u/16213161?s=400&u=e61da9f734de6454e61f4eff08eb913aa5e33be3&v=4"/></div><div class="pure-u-md-1-1 pure-u-3-4"><h1 class="brand-title">Chad Rutherford</h1><h3 class="brand-tagline">iOS Developer with experience in Swift and Objective-C</h3></div></div><div id="layout" class="pure-g"><div class="pure-u-md-1-1"><a href="https://en.wikipedia.org/wiki/Weirton,_West_Virginia"><i class="fas fa-map-marker-alt l-box social icon"></i><a class="social-media" href="https://en.wikipedia.org/wiki/Weirton,_West_Virginia">Weirton, WV USA</a></a></div><div class="pure-u-md-1-1"><a href="mailto:chad_rutherford@outlook.com"><i class="fas fa-envelope-open-text l-box social icon"></i><a class="social-media" href="mailto:chad_rutherford@outlook.com">Email</a></a></div><div class="pure-u-md-1-1"><a href="https://www.linkedin.com/in/chadarutherford"><i class="fa fa-linkedin l-box social icon"></i><a class="social-media" href="https://www.linkedin.com/in/chadarutherford">LinkedIn</a></a></div><div class="pure-u-md-1-1"><a href="https://github.com/chadarutherford"><i class="fa fa-github-square l-box social icon"></i><a class="social-media" href="https://github.com/chadarutherford">GitHub</a></a></div><div class="pure-u-md-1-1"><a href="https://twitter.com/chadiosdev"><i class="fa fa-twitter-square l-box social icon"></i><a class="social-media" href="https://twitter.com/chadiosdev">Twitter</a></a></div></div></div></div><div class="content pure-u-1 pure-u-md-3-5 pure-u-xl-6-10"><h2 class="post-title"><a href="/posts/2020-10-01JetFuelTakeHome">Implementing a take home challenge for practice</a></h2><p class="post-meta">October 1, 2020</p><div class="post-tags"><a class="post-category post-category-blog" href="/tags/blog">Blog</a><a class="post-category post-category-swift" href="/tags/swift">Swift</a><a class="post-category post-category-take home" href="/tags/take-home">Take Home</a></div><div class="post-description"><div><h2>Attempting a Take Home Challenge</h2><hr><p>In search of new ways to keep my skills sharp, I recently decided to go in search of an iOS take home challenge I could complete. I stumbled on a take home project from reallabs called the JetFuel Take Home Exercise here: <a href="https://github.com/reallabs/ios-take-home">TakeHomeChallenge</a></p><p>So to start out, I started a new Xcode project, setting up my structure and adding the testing framework.</p><p>Then after completing the restructure I decided this was going to really stretch my skills by utilizing the nested UICollectionViews inside each other 100% programmatically. To do this I had to go into the info.plist -&gt; Application Scene Manifest -&gt; Scene Configuration -&gt; Application Session Role -&gt; Item 0 and remove the key for Storyboard Name (click on the minus). After that, I went to the general settings for the project and deleted Main from the Main interface section. The only thing left to do to remove a storyboard approach wqas to remove Main.Storyboard from the project.</p><p>Next was setting up a programmatic approach in SceneDelegate. Thankfully they already had a decent starting point to which I could add on to. I named the windowScene Apple set up to windowScene instead of _. Next I had to create a window by setting <code></code><code>window = UIWindow(windowScene: windowScene)</code><code></code>. I then set <code></code><code>window.rootViewController = ViewController</code><code></code> and set <code></code><code>window.makeKeyAndVisible()</code><code></code>. To prove I set this up correctly, I went into ViewController.swift and inside viewDidLoad(), I set <code></code><code>view.backgroundColor = .systemTeal</code><code></code>. Build and run....</p><img src="/images/posts/TakeHomeChallenge/testScreen.png" alt="testScreen" width="500"/><p>Success!</p><p>Now on to making this a collectionview. I went back to SceneDelegate and created a Navigation Controller with the view controller as the root with the following code.</p><pre><code><span class="keyword">let</span> layout = <span class="type">UICollectionViewFlowLayout</span>()
layout.<span class="property">scrollDirection</span> = .<span class="dotAccess">vertical</span>
<span class="keyword">let</span> feedCollectionViewController = <span class="type">FeedCollectionViewController</span>(collectionViewLayout: layout)
<span class="keyword">let</span> navController = <span class="type">UINavigationController</span>(rootViewController: feedCollectionViewController)
window?.<span class="property">rootViewController</span> = navController
window?.<span class="call">makeKeyAndVisible</span>()
</code></pre><p>This gave me a setup UICollectionViewController to work with. Now I needed to make it show something to verify it was working. By setting numberOfItemsInSection to 5 and creating a new CollecitonViewCell subclass and registering it in viewDidLoad, I now had a working CollectionView...</p><img src="/images/posts/TakeHomeChallenge/firstCVCells.png" alt="firstCVCells" width="500"/><p>The next step was to make the cells bigger and start adding and constraining items in it to match the design spec. I extended FeedCollectionViewController to conform to UICollectionViewDelegateFlowLayout and set up a <code></code><code>CGSize(width: collectionView.frame.width, height: 360)</code><code></code> and then added programmatic UI Elements. Starting with a UIImageView, I pinned it to the top of the contentView and constrained it's width and height. then I added 3 labels. One for the campaign name, price per download and a label to say "per install".</p><p>This is what my configureUI method looks like:</p><pre><code><span class="keyword">private func</span> configureUI() {
	contentView.<span class="call">addSubview</span>(iconImageView)
	contentView.<span class="call">addSubview</span>(nameLabel)
	contentView.<span class="call">addSubview</span>(payLabel)
	contentView.<span class="call">addSubview</span>(payPerInstallLabel)
	<span class="type">NSLayoutConstraint</span>.<span class="call">activate</span>([
		
		iconImageView.<span class="property">topAnchor</span>.<span class="call">constraint</span>(equalTo: contentView.<span class="property">topAnchor</span>, constant: <span class="number">20</span>),
		iconImageView.<span class="property">leadingAnchor</span>.<span class="call">constraint</span>(equalTo: contentView.<span class="property">leadingAnchor</span>, constant: <span class="number">20</span>),
		iconImageView.<span class="property">heightAnchor</span>.<span class="call">constraint</span>(equalToConstant: <span class="number">60</span>),
		iconImageView.<span class="property">widthAnchor</span>.<span class="call">constraint</span>(equalTo: iconImageView.<span class="property">heightAnchor</span>, multiplier: <span class="number">1</span>),
		
		nameLabel.<span class="property">topAnchor</span>.<span class="call">constraint</span>(equalTo: iconImageView.<span class="property">topAnchor</span>, constant: <span class="number">8</span>),
		nameLabel.<span class="property">leadingAnchor</span>.<span class="call">constraint</span>(equalTo: iconImageView.<span class="property">trailingAnchor</span>, constant: <span class="number">16</span>),
		nameLabel.<span class="property">trailingAnchor</span>.<span class="call">constraint</span>(greaterThanOrEqualTo: contentView.<span class="property">trailingAnchor</span>, constant: -<span class="number">20</span>),
		nameLabel.<span class="property">heightAnchor</span>.<span class="call">constraint</span>(equalToConstant: <span class="number">20</span>),
		
		payLabel.<span class="property">topAnchor</span>.<span class="call">constraint</span>(equalTo: nameLabel.<span class="property">bottomAnchor</span>),
		payLabel.<span class="property">leadingAnchor</span>.<span class="call">constraint</span>(equalTo: nameLabel.<span class="property">leadingAnchor</span>),
		payLabel.<span class="property">heightAnchor</span>.<span class="call">constraint</span>(equalToConstant: <span class="number">25</span>),
		payLabel.<span class="property">trailingAnchor</span>.<span class="call">constraint</span>(equalTo: payPerInstallLabel.<span class="property">leadingAnchor</span>, constant: -<span class="number">4</span>),
		
		payPerInstallLabel.<span class="property">topAnchor</span>.<span class="call">constraint</span>(equalTo: nameLabel.<span class="property">bottomAnchor</span>),
		payPerInstallLabel.<span class="property">heightAnchor</span>.<span class="call">constraint</span>(equalToConstant: <span class="number">25</span>)
	])
}
</code></pre><p>and here are the results:</p><img src="/images/posts/TakeHomeChallenge/dummyCVCells.png" alt="dummyCVCells" width="500"/><p>Now that I had a framework to display the data with, it was time to ping the server and popualte the UI Elements with real data. So I worked in the API calls, and routed the objects to their correct places using cellForRowAt. I decided to display it using the old UICollectionViewDataSource methods for now. Will re-implement with UICollectionViewDiffableDataSource later. So the network calls are back and the data has been validated using Unit Tests to make sure the JSON is being parsed correctly using Codable. Now it's time for the green light moment. Build and run and.......</p><img src="/images/posts/TakeHomeChallenge/feedCVCells.png" alt="feedCVCells" width="500"/><p>We have icons, names and price per download all populating correctly!</p><p>The next task was to populate the inner cells with buttons and images for "previews" of the video files at the URLs. So I againg went about laying out the framework for my UI Elements, using scaffolding and sizes for my dummy views and background colors so I could see the shape and size and get the layout looking good. So I added a collectionView property to each feed cell. and UI Elements to each cell. I needed two buttons and a UIImageView. The buttons would not change based on data so i laid them out the way they would be and used a blue blank image view to place the previews.</p><img src="/images/posts/TakeHomeChallenge/mediaCVCells.png" alt="mediaCVCells" width="500"/><p>The next task was to populate the image views with the preview thumbnails and play buttons for the video files. So off to another network call this time for the download URL attached to every Media object. This task was particularly easy as I already had the networking framework set up, all I had to do was call it. Build and run.....</p><img src="/images/posts/TakeHomeChallenge/mediaPreviewCVCells.png" alt="mediaPreviewCVCells" width="500"/><p>Perfect!</p><p>The last items were to add a copy link to clip board function connected to the link button:</p><pre><code>linkButton.<span class="call">addTarget</span>(<span class="keyword">self</span>, action: <span class="keyword">#selector</span>(copyLink), for: .<span class="dotAccess">touchUpInside</span>)
<span class="keyword">@objc private func</span> copyLink() {
	<span class="keyword">guard let</span> media = media <span class="keyword">else</span> { <span class="keyword">return</span> }
	<span class="keyword">let</span> pasteboard = <span class="type">UIPasteboard</span>.<span class="property">general</span>
	pasteboard.<span class="property">string</span> = media.<span class="property">trackingLink</span>.<span class="property">absoluteString</span>
}
</code></pre><p>this allows the user to copy the link for the video in that cell to their clipboard. And the final MVP task was to enable the user to download the video to their device. This is done here:</p><pre><code>downloadButton.<span class="call">addTarget</span>(<span class="keyword">self</span>, action: <span class="keyword">#selector</span>(downloadMedia), for: .<span class="dotAccess">touchUpInside</span>)
<span class="keyword">@objc private func</span> downloadMedia() {
	<span class="keyword">guard let</span> media = media <span class="keyword">else</span> { <span class="keyword">return</span> }
	<span class="type">DispatchQueue</span>.<span class="call">global</span>(qos: .<span class="dotAccess">background</span>).<span class="call">async</span> {
		<span class="keyword">if let</span> urlData = <span class="keyword">try</span>? <span class="type">Data</span>(contentsOf: media.<span class="property">downloadURL</span>) {
			<span class="keyword">let</span> documentsPath = <span class="type">NSSearchPathForDirectoriesInDomains</span>(.<span class="dotAccess">documentDirectory</span>, .<span class="dotAccess">userDomainMask</span>, <span class="keyword">true</span>)[<span class="number">0</span>]
			<span class="keyword">let</span> filePath = <span class="type">URL</span>(fileURLWithPath: <span class="string">"</span>\(documentsPath)<span class="string">/tempFile.mp4"</span>)
			<span class="type">DispatchQueue</span>.<span class="property">main</span>.<span class="call">async</span> {
				<span class="keyword">do</span> {
					<span class="keyword">try</span> urlData.<span class="call">write</span>(to: filePath)
				} <span class="keyword">catch</span> {
					<span class="call">print</span>(error)
				}
				<span class="type">PHPhotoLibrary</span>.<span class="call">shared</span>().<span class="call">performChanges</span> {
					<span class="type">PHAssetChangeRequest</span>.<span class="call">creationRequestForAssetFromVideo</span>(atFileURL: filePath)
				} completionHandler: { completed, error <span class="keyword">in
					if</span> completed {
						<span class="call">print</span>(<span class="string">"Video saved!"</span>)
					}
				}
			}
		}
	}
}
</code></pre><p>As a stretch (bonus) goal I wanted to implement functionality to enable the user to play the video file in AVPlayerViewController but I haven't figured out a solution to this yet. This was a fun project and even though I went 7 hours over the 3 hour limit, I learned a lot about CollectionViews and nesting them inside one another.</p><p>Til next time, Ciao! Chad</p></div></div></div><div class="footer pure-u-1"><div class="pure-u-1">© 2020 Chad Rutherford</div><div class="pure-u-1">Generated using <a href="https://github.com/johnsundell/publish">Publish</a>. Written in Swift</div></div></div></body></html>